%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Copyright (c) 2001 by Erik Johansson.  All Rights Reserved 
%% Time-stamp: <01/06/13 10:43:09 happi>
%% ====================================================================
%%  Filename : 	bs5.erl
%%  Module   :	bs5
%%  Purpose  :  
%%  Notes    : 
%%  History  :	* 2001-06-13 Erik Johansson (happi@csd.uu.se): 
%%               Created.
%%  CVS      :
%%              $Author: pergu $
%%              $Date: 2005/07/07 14:02:27 $
%%              $Revision: 1.4 $
%% ====================================================================
%%  Exports  :
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

-define(T(A,B), {A,B}).

-module(bs5).
-export([test/0,compile/1]).

compile(O) ->
  hipe:c(?MODULE,O).

r(L) ->
    lists:reverse(L).

test() ->
    [
      ?T(<<-43>>,
 	[256-43]),
      ?T(<<56>>,
 	[56]),
      ?T(<<1,2>>,
 	[1, 2]),
      ?T(<<4:4, 7:4>>,
 	[4*16+7]),
     ?T(<<1:5, 1:11>>,
 	[1*8, 1]),
      ?T(<<777:16/big>>,
 	[3, 9]),
      ?T(<<777:16/little>>,
 	[9, 3]),
      ?T(<<0.0:32/float>>,
 	[0,0,0,0]),
      ?T(<<0.125:32/float>>,
 	[62,0,0,0]),
      ?T(<<0.125:32/little-float>>,
 	[0,0,0,62]),
      ?T(<<57285702734876389752897683:32>>,
 	[138, 99, 0, 147]),
      ?T(<<57285702734876389752897684:32>>,
 	[138, 99, 0, 148]),
      ?T(<<57285702734876389752897683:32/little>>,
 	r([138, 99, 0, 147])),
      ?T(<<-1:17/unit:8>>,
 	lists:duplicate(17, 255)),

      ?T(<<13>>,
 	[13]),

      ?T(<<4:8/unit:2,5:2/unit:8>>,
 	[0, 4, 0, 5]),

     ?T(<<1:1, 0:6, 1:1>>,
	[129]),
      ?T(<<1:1/little, 0:6/little, 1:1/little>>,
 	[129]),

      ?T(<<<<1,2>>/binary>>,
 	[1, 2]),
      ?T(<<<<1,2>>:1/binary>>,
 	[1]),
      ?T(<<4,3,<<1,2>>:1/binary>>,
 	[4,3,1]),

      ?T(<<(256*45+47)>>,
 	[47]),

      ?T(<<57:0>>,
 	[]),

      ?T(<<"apa">>,
 	"apa"),

      ?T(<<1:3,"string",9:5>>,
 	[46,110,142,77,45,204,233]),

      ?T(<<>>,
 	[])
     ].
